<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Frequency analysis of a Belgian Motor Third Party Liability dataset • CASdatasets</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="gam_rc_phileas_vignette_files/libs/quarto-html/popper.min.js"></script><script src="gam_rc_phileas_vignette_files/libs/quarto-html/tippy.umd.min.js"></script><link href="gam_rc_phileas_vignette_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="gam_rc_phileas_vignette_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link rel="stylesheet" href="style.scss">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Frequency analysis of a Belgian Motor Third Party Liability dataset">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CASdatasets</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/CASdatasets.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/poisson_vignette.html">Frequency analysis of a French Motor Third Party Liability dataset</a></li>
    <li><a class="dropdown-item" href="../articles/quasi_poisson_vignette_ausprivauto0405.html">Frequency analysis of an Australian Motor Third Party Liability dataset</a></li>
    <li><a class="dropdown-item" href="../articles/gam_rc_phileas_vignette.html">Frequency analysis of a Belgian Motor Third Party Liability dataset</a></li>
    <li><a class="dropdown-item" href="../articles/zero_inflated_vignette.html">Frequency analysis of a Norwegian Motor Third Party Liability dataset</a></li>
    <li><a class="dropdown-item" href="../articles/zero_inflated_vignette_freMTPL.html">Frequency analysis with a Zero Inflated Regression of a French Motor Third Party Liability dataset</a></li>
    <li><a class="dropdown-item" href="../articles/triangle_vignette.html">Claims reserving of a French Motor Third Party Liability triangle dataset</a></li>
    <li><a class="dropdown-item" href="../articles/triangle_aids_vignette.html">Reserving exercice on reporting delays in AIDS Data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dutangc/CASdatasets/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Frequency analysis of a Belgian Motor Third Party Liability dataset</h1>

      <p class="author">Siharath Julien</p>
      <p class="date">September, 2024</p>

      <small class="dont-index">Source: <a href="https://github.com/dutangc/CASdatasets/blob/master/vignettes/gam_rc_phileas_vignette.qmd" class="external-link"><code>vignettes/gam_rc_phileas_vignette.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <section class="section level2"><h2 id="sec-gam-introduction">Introduction<a class="anchor" aria-label="anchor" href="#sec-gam-introduction"></a>
</h2>
<div class="cell">
<details class="code-fold"><summary>Session Settings</summary><div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Graphs----</span></span>
<span><span class="va">face_text</span><span class="op">=</span><span class="st">'plain'</span></span>
<span><span class="va">face_title</span><span class="op">=</span><span class="st">'plain'</span></span>
<span><span class="va">size_title</span> <span class="op">=</span> <span class="fl">14</span></span>
<span><span class="va">size_text</span> <span class="op">=</span> <span class="fl">11</span></span>
<span><span class="va">legend_size</span> <span class="op">=</span> <span class="fl">11</span></span>
<span></span>
<span><span class="va">global_theme</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">%+replace%</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span></span>
<span>      text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="va">size_text</span>, face <span class="op">=</span> <span class="va">face_text</span><span class="op">)</span>,</span>
<span>      legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>      legend.direction <span class="op">=</span> <span class="st">"horizontal"</span>, </span>
<span>      legend.box <span class="op">=</span> <span class="st">"vertical"</span>,</span>
<span>      legend.key <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>      legend.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="va">legend_size</span><span class="op">)</span>,</span>
<span>      axis.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="va">size_text</span>, face <span class="op">=</span> <span class="va">face_text</span><span class="op">)</span>, </span>
<span>      plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span></span>
<span>        size <span class="op">=</span> <span class="va">size_title</span>, </span>
<span>        hjust <span class="op">=</span> <span class="fl">0.5</span></span>
<span>      <span class="op">)</span>,</span>
<span>      plot.subtitle <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Outputs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"digits"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<div class="cell">
<style type="text/css">
.justify {
  text-align: justify !important
}
</style>
</div>
<div>
<blockquote>
<p><strong>In Brief</strong></p>
<p>The objective of this vignette is to illustrate the practical application of Generalized Additive Models (GAM) in analyzing insurance data, with an emphasis on the <code>beMTPL</code> dataset from <span class="citation" data-cites="charpentierCAS">Charpentier (<a href="#ref-charpentierCAS" role="doc-biblioref">2014</a>)</span>. Our focus lies in public liability for drivers, particularly in providing comprehensive insights into insurance contracts and claims associated with Belgium motor third-party liability insurance. Our objective is to develop a model to explore the factors that impact claim occurrences within the insurance dataset, with a special focus on the elderly.</p>
</blockquote>
</div>
<section class="level2"><h3 id="required-packages">Required Packages<a class="anchor" aria-label="anchor" href="#required-packages"></a>
</h3>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">required_libraries</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"tidyverse"</span>, </span>
<span>  <span class="st">"CASdatasets"</span>,</span>
<span>  <span class="st">"wesanderson"</span>,</span>
<span>  <span class="st">"mgcv"</span>,</span>
<span>  <span class="st">"broom"</span>,</span>
<span>  <span class="st">"knitr"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">required_libraries</span>, <span class="va">library</span>, character.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
</section><section class="level2"><h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<div class="justify">
<p>The data used in this vignette come from the Belgium motor third-party liability insurance portfolio.</p>
<p>The dataset, <code>beMTPL</code>, encompasses details regarding contracts and clients obtained from a Belgium insurance company, related to a public liability insurance portfolio.</p>
<p>For convenience, the <code>beMTPL</code> table will be referred to as <code>CLAIMS</code>.</p>
</div>
</section><section class="level2"><h3 id="dictionaries">Dictionaries<a class="anchor" aria-label="anchor" href="#dictionaries"></a>
</h3>
<p>The list of the 22 variables from the <code>beMTPL</code> dataset is reported in <a href="#tbl-dict-beMTPL" class="quarto-xref">Table 1</a>.</p>
<div class="justify">
<div id="tbl-dict-beMTPL" class="striped hover quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-dict-beMTPL-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 1: Content of the <code>beMTPL</code> dataset: <code>CLAIMS</code>
</figcaption><div aria-describedby="tbl-dict-beMTPL-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table table-striped table-hover caption-top">
<colgroup>
<col style="width: 40%">
<col style="width: 20%">
<col style="width: 38%">
</colgroup>
<thead><tr class="header">
<th>Attribute</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>insurance_contract</td>
<td>Numeric</td>
<td>Unique identifier for the contract</td>
</tr>
<tr class="even">
<td>policy_year</td>
<td>Numeric</td>
<td>Year of study or observation for the insured person</td>
</tr>
<tr class="odd">
<td>insured_year_birth</td>
<td>Numeric</td>
<td>insured’s year of birth</td>
</tr>
<tr class="even">
<td>exposure</td>
<td>Numeric</td>
<td>Exposure duration in years</td>
</tr>
<tr class="odd">
<td>vehicle_age</td>
<td>Numeric</td>
<td>Age of the vehicle in years</td>
</tr>
<tr class="even">
<td>policy_holder_age</td>
<td>Numeric</td>
<td>Seniority of the insured at the insurance agency</td>
</tr>
<tr class="odd">
<td>driver_license_age</td>
<td>Numeric</td>
<td>Age of the driver’s licence</td>
</tr>
<tr class="even">
<td>vehicle_brand</td>
<td>Character</td>
<td>Brand of the vehicle</td>
</tr>
<tr class="odd">
<td>mileage</td>
<td>Numeric</td>
<td>Mileage of the vehicle</td>
</tr>
<tr class="even">
<td>vehicle_power</td>
<td>Numeric</td>
<td>Power value of the vehicle</td>
</tr>
<tr class="odd">
<td>catalog_value</td>
<td>Numeric</td>
<td>Catalog value of the vehicle</td>
</tr>
<tr class="even">
<td>claim_value</td>
<td>Numeric</td>
<td>Value of the claim</td>
</tr>
<tr class="odd">
<td>number_of_liability_claims</td>
<td>Numeric</td>
<td>Number of liability claims</td>
</tr>
<tr class="even">
<td>number_of_bodily_injury_liability_claims</td>
<td>Numeric</td>
<td>Number of bodily injury liability claims</td>
</tr>
<tr class="odd">
<td>claim_time</td>
<td>Numeric</td>
<td>Time of the accident</td>
</tr>
<tr class="even">
<td>claim_responsibility_rate</td>
<td>Numeric</td>
<td>Rate of responsibility for the claim (100% full responsibility, 0% no responsibility</td>
</tr>
<tr class="odd">
<td>driving_training_label</td>
<td>Bolean</td>
<td>Bolean indicating driving training</td>
</tr>
<tr class="even">
<td>signal</td>
<td>Bolean</td>
<td>1 = warning, 0 = no warning</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</section><section class="level2"><h3 id="importation">Importation<a class="anchor" aria-label="anchor" href="#importation"></a>
</h3>
<div class="cell">
<details class="code-fold"><summary>Code for importing our datasets</summary><div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">beMTPL16</span><span class="op">)</span></span>
<span></span>
<span><span class="va">CLAIMS</span> <span class="op">&lt;-</span> <span class="va">beMTPL16</span></span>
<span></span>
<span><span class="va">CLAIMS</span> <span class="op">&lt;-</span> <span class="va">CLAIMS</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>insured_age <span class="op">=</span> <span class="fl">2016</span> <span class="op">-</span> <span class="va">insured_birth_year</span><span class="op">)</span></span>
<span></span>
<span><span class="va">CLAIMS</span> <span class="op">&lt;-</span> <span class="va">CLAIMS</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">insurance_contract</span>, <span class="va">policy_year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>ClaimNB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">number_of_liability_claims</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
</section></section><section class="section level2"><h2 id="sec-gam-models">Models<a class="anchor" aria-label="anchor" href="#sec-gam-models"></a>
</h2>
<section class="level2"><h3 id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h3>
<div class="justify">
<p>In the domain of public liability for automobile accidents, particularly with a focus on elderly drivers, Generalized Additive Models (GAM) are a reliable tool for understanding and predicting accident frequencies, repair costs, and claim patterns.</p>
<p>By employing GAM, insurers can better anticipate future challenges, refine pricing strategies, and enhance their resilience in an ever-evolving risk environment, specifically addressing the unique risks associated with elderly drivers.</p>
</div>
<div class="justify">
<p>In this analysis, we explore the relationship between the response variable <code>target</code> and the explanatory variables <code>DriverAge</code> and <code>vehicle_age</code>. This modeling framework aligns with the principles outlined by <span class="citation" data-cites="agresti">Agresti (<a href="#ref-agresti" role="doc-biblioref">2013</a>)</span>, a prominent figure in statistical methodology, who emphasizes the importance of considering multiple explanatory factors in regression analysis.</p>
<p>To model the frequency of insurance claims, we employ a Generalized Additive Model (GAM) approach for the response variable <code>ClaimNB</code>, which represents the count of insurance claims and is assumed to follow a Quasi-Poisson distribution:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">ClaimNB</mtext><mo>∼</mo><mtext mathvariant="normal">QuasiPoisson</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\text{ClaimNB} \sim \text{QuasiPoisson}(\lambda),
</annotation></semantics></math></p>
<p>where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math> is the mean rate of claims. The GAM approach allows for flexible, nonlinear relationships between <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math> and the predictor variables through the use of smooth functions. Specifically, we express the natural logarithm of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math> as a combination of these smooth functions and an additional term accounting for exposure:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>f</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">insured age</mtext><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>f</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">vehicle age</mtext><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">exposure</mtext><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\begin{equation}
\log(\lambda_i) = \beta_0 + f_1(\text{insured age}_i) + f_2(\text{vehicle age}_i) + \log(\text{exposure}),
\end{equation}
</annotation></semantics></math></p>
<p>where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">insured age</mtext><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f_1(\text{insured age}_i)</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">vehicle age</mtext><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f_2(\text{vehicle age}_i)</annotation></semantics></math> are smooth functions of the predictor variables.</p>
<p>In this model, <code>DriverAge</code> represents the age of the insured individual, <code>vehicle_age</code> denotes the age of the vehicle, and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">exposure</mtext><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log(\text{exposure})</annotation></semantics></math> adjusts for the exposure variable. The intercept <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\beta_0</annotation></semantics></math> and the smooth functions <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mn>1</mn></msub><annotation encoding="application/x-tex">f_1</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mn>2</mn></msub><annotation encoding="application/x-tex">f_2</annotation></semantics></math> are estimated through regression to quantify their impact on the expected rate of claims. The smooth functions allow the model to capture complex, nonlinear relationships between the predictors and the response variable, providing a more flexible and accurate fit to the data.</p>
</div>
<p>The estimated lambda parameter, which represents the mean of claims, is 0.37.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">theoretic_count</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">CLAIMS</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">CLAIMS</span><span class="op">$</span><span class="va">ClaimNB</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tc_df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span><span class="va">theoretic_count</span><span class="op">)</span></span>
<span></span>
<span><span class="va">freq_theoretic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">tc_df</span><span class="op">$</span><span class="va">theoretic_count</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">freq_claim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">CLAIMS</span><span class="op">$</span><span class="va">ClaimNB</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">freq_theoretic_df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span></span>
<span>  Count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">freq_theoretic</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Frequency <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">freq_theoretic</span><span class="op">)</span>,</span>
<span>  Source <span class="op">=</span> <span class="st">"Theoretical Count"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">freq_claim_df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span></span>
<span>  Count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">freq_claim</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Frequency <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">freq_claim</span><span class="op">)</span>,</span>
<span>  Source <span class="op">=</span> <span class="st">"Empirical Count"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">freq_combined</span> <span class="op">&lt;-</span> <span class="va">freq_theoretic_df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">freq_claim_df</span><span class="op">)</span></span></code></pre></div>
</div>
<p>The theoretical and empirical histograms associated with a Poisson distribution are shown in <a href="#fig-plot-hist-claims" class="quarto-xref">Figure 1</a>.</p>
<div class="cell">
<details class="code-fold"><summary>Code for the following graph</summary><div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">freq_combined</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Count</span>, y <span class="op">=</span> <span class="va">Frequency</span>, fill <span class="op">=</span> <span class="va">Source</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge2"</span>, width <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Claim Number"</span>, y <span class="op">=</span> <span class="st">"Frequency"</span>, fill <span class="op">=</span> <span class="st">"Legend"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span></span>
<span>    <span class="cn">NULL</span>,</span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Empirical Count"</span> <span class="op">=</span> <span class="st">"black"</span>, <span class="st">"Theoretical Count"</span> <span class="op">=</span> <span class="st">"#1E88E5"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Legend"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Claim Number"</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">global_theme</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div id="fig-plot-hist-claims" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-plot-hist-claims-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 1: <span style="color: #1E88E5;">Theoretical</span> and <span style="color: black;">empirical</span> histogram of claims in frequence
</figcaption><div aria-describedby="fig-plot-hist-claims-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gam_rc_phileas_vignette_files/figure-html/fig-plot-hist-claims-1.png" width="768">
</div>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reg</span> <span class="op">&lt;-</span> <span class="fu">gam</span><span class="op">(</span></span>
<span>  <span class="va">ClaimNB</span> <span class="op">~</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="fu">s</span><span class="op">(</span><span class="va">insured_age</span><span class="op">)</span> <span class="op">+</span> <span class="fu">s</span><span class="op">(</span><span class="va">vehicle_age</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">exposure</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="va">quasipoisson</span>,</span>
<span>  data <span class="op">=</span> <span class="va">CLAIMS</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">reg</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Family: quasipoisson
Link function: log

Formula:
ClaimNB ~ -1 + s(insured_age) + s(vehicle_age) + offset(log(exposure))

Approximate significance of smooth terms:
                edf Ref.df   F p-value
s(insured_age) 4.80   5.78 105  &lt;2e-16 ***
s(vehicle_age) 3.94   4.71 468  &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

R-sq.(adj) =  -0.0915   Deviance explained =   -5%
GCV = 0.79694  Scale est. = 0.75161   n = 70791</code></pre>
</div>
</div>
<div class="justify">
<p>This generalized additive model (GAM) predicts the number of claims based on <code>insured_age</code> and <code>vehicle_age</code> as predictors. The smooth terms in the model are statistically significant, indicating that both <code>insured_age</code> and <code>vehicle_age</code> have a meaningful effect on the number of claims.</p>
<p>A positive coefficient for <code>s(insured_age)</code> suggests that increasing the age of the insured is associated with a higher expected log count of total liability claims. Similarly, the positive coefficient for <code>s(vehicle_age)</code> indicates that an increase in vehicle age is linked to a higher expected log count of claims.</p>
</div>
</section></section><section class="section level2"><h2 id="sec-gam-graphs">Graphs<a class="anchor" aria-label="anchor" href="#sec-gam-graphs"></a>
</h2>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">DriverAge vehicle_age 3D perspective influence</a></li></ul>
<ul class="nav nav-tabs" id="NA" role="tablist"><li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#NA" id="NA-tab" type="button" role="tab" aria-controls="NA" aria-selected="true" class="active nav-link">
<div class="cell">
<details class="code-fold"><summary>Code to create the following graph</summary><div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">constant_offset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">CLAIMS</span><span class="op">$</span><span class="va">exposure</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">pgam</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span></span>
<span>    <span class="va">reg</span>,</span>
<span>    newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      vehicle_age <span class="op">=</span> <span class="va">x1</span>, </span>
<span>      insured_age <span class="op">=</span> <span class="va">x2</span>, </span>
<span>      exposure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">constant_offset</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"response"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fl">31</span></span>
<span><span class="va">cx1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">CLAIMS</span><span class="op">$</span><span class="va">vehicle_age</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">CLAIMS</span><span class="op">$</span><span class="va">vehicle_age</span><span class="op">)</span>, length <span class="op">=</span> <span class="va">M</span><span class="op">)</span></span>
<span><span class="va">cx2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">CLAIMS</span><span class="op">$</span><span class="va">insured_age</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">CLAIMS</span><span class="op">$</span><span class="va">insured_age</span><span class="op">)</span>, length <span class="op">=</span> <span class="va">M</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">Pgam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="va">cx1</span>, <span class="va">cx2</span>, <span class="fu"><a href="https://rdrr.io/r/base/Vectorize.html" class="external-link">Vectorize</a></span><span class="op">(</span><span class="va">pgam</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/persp.html" class="external-link">persp</a></span><span class="op">(</span></span>
<span>  <span class="va">cx1</span>, <span class="va">cx2</span>, <span class="va">Pgam</span>, theta <span class="op">=</span> <span class="fl">30</span>, phi <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Vehicle Age"</span>, ylab <span class="op">=</span> <span class="st">"Insured Age"</span>, zlab <span class="op">=</span> <span class="st">"Predicted Claims"</span>,</span>
<span>  main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span>
<span>    <span class="st">"Predicted Claims with Constant Offset (log(exposure) ="</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">constant_offset</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">")"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div id="fig-plot-perspective" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-plot-perspective-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 2: 3D impact perspective: DriverAge and vehicle_age
</figcaption><div aria-describedby="fig-plot-perspective-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gam_rc_phileas_vignette_files/figure-html/fig-plot-perspective-1.png" width="768">
</div>
</figure>
</div>
</div>
</div>
</button></li></ul>
<div class="tab-content"><div class="active  tab-pane" id="NA" role="tabpanel" aria-labelledby="NA-tab">

</div></div>
</div>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby">
<li><a data-tabby-default="" href="#tabset-2-1">DriverAge</a></li>
<li><a href="#tabset-2-2">vehicle_age</a></li>
</ul>
<ul class="nav nav-tabs" id="NA" role="tablist"><li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#NA" id="NA-tab" type="button" role="tab" aria-controls="NA" aria-selected="true" class="active nav-link">
<div class="cell">
<details class="code-fold"><summary>Code to create the following graph</summary><div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">reg</span>, select <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div id="fig-plot-coef-driverage" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-plot-coef-driverage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 3: Estimated effects of DriverAge
</figcaption><div aria-describedby="fig-plot-coef-driverage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gam_rc_phileas_vignette_files/figure-html/fig-plot-coef-driverage-1.png" width="768">
</div>
</figure>
</div>
</div>
</div>
<p>The plot displays the smooth function of <code>insured_age</code> from the Generalized Additive Model (GAM). The solid line represents the estimated effect of <code>insured_age</code> on the log count of claims, with the dashed lines indicating 95% confidence intervals.</p>
<ul>
<li>
<strong>Trend</strong>: The effect of <code>insured_age</code> is relatively flat for ages 60 to 70, suggesting minimal impact on claims. However, as age increases beyond 80, the smooth function rises, indicating a higher expected log count of claims with increasing age.</li>
<li>
<strong>Nonlinearity</strong>: The curve demonstrates a nonlinear relationship, capturing the increasing risk associated with older insured individuals.</li>
<li>
<strong>Significance</strong>: The upward trend, especially beyond age 80, suggests a significant increase in claim risk for older drivers, with the confidence intervals indicating reliability in these estimates.</li>
</ul>
<p>This plot suggests that insurers should consider the increasing risk with age, particularly for insured individuals over 80 years old, when assessing premiums and risk.</p>
</button></li></ul>
<div class="tab-content"><div class="active  tab-pane" id="NA" role="tabpanel" aria-labelledby="NA-tab">

<div id="tabset-2-2">
<div class="cell">
<details class="code-fold"><summary>Code to create the following graph</summary><div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">reg</span>, select <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div id="fig-plot-coef-vehicle-age" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-plot-coef-vehicle-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 4: Estimated effects of vehicle age
</figcaption><div aria-describedby="fig-plot-coef-vehicle-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="gam_rc_phileas_vignette_files/figure-html/fig-plot-coef-vehicle-age-1.png" width="768">
</div>
</figure>
</div>
</div>
</div>
</div>
</div></div>
</div>
</section><section class="section level2"><h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-agresti" class="csl-entry" role="listitem">
Agresti, Alan. 2013. <em>Categorical Data Analysis, 3rd Edition</em>.
</div>
<div id="ref-charpentierCAS" class="csl-entry" role="listitem">
Charpentier, Arthur. 2014. <em>Computational Actuarial Science with <span>R</span></em>. The <span>R</span> Series. Chapman; Hall/CRC. <a href="https://www.routledge.com/Computational-Actuarial-Science-with-R/Charpentier/p/book/9781138033788" class="external-link">https://www.routledge.com/Computational-Actuarial-Science-with-R/Charpentier/p/book/9781138033788</a>.
</div>
</div>
</section><section class="section level2"><h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h2>
<div class="justify">
<p>For more similar claim frequency datasets with a Poisson-like distribution, see <a href="https://dutangc.github.io/CASdatasets/reference/freMTPL.html" class="external-link"><code>freMTPL</code></a> (import with <code>data("freMTPLfreq")</code>): French automobile dataset, <a href="https://dutangc.github.io/CASdatasets/reference/norauto.html" class="external-link"><code>norauto</code></a>: Norwegian automobile dataset (import with <code>data("norauto")</code>), <a href="https://dutangc.github.io/CASdatasets/reference/ausprivauto.html" class="external-link"><code>ausprivauto0405</code></a> (import with <code>data("ausprivauto0405")</code>): Australian automobile dataset, or <a href="https://dutangc.github.io/CASdatasets/reference/pricingame.html" class="external-link"><code>pg17trainpol</code></a> (import with <code>data("pg17trainpol")</code>).</p>
</div>
</section><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'light-border',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config);
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="http://dutangc.free.fr" class="external-link">Christophe Dutang</a>, <a href="https://freakonometrics.github.io" class="external-link">Arthur Charpentier</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
